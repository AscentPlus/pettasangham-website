<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery | Ambalapuzha Yogam Sangham Trust</title>
    <link rel="stylesheet" href="./gallery.css">
    <script src="./gallery-data.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="shortcut icon" href="./images/ayyappan.png">
</head>

<body>

    <nav class="navbar">
        <div class="logoimg">
            <img src="./images/ayyappan.png" alt="logo" class="logo-icon">
        </div>
        <div class="logo">
            Ambalapuzha Yogam Petta Sangham
        </div>
        <ul class="nav-links">
            <li><a href="./index.html">Home</a></li>
            <li><a href="./index.html#about">About Us</a></li>
            <li><a href="./history.html">History</a></li>
            <li><a href="./index.html#events">Events</a></li>
            <!-- <li><a href="./index.html#petta">Petta Thullal</a></li> -->
            <li><a href="./index.html#calendar">Calendar</a></li>
            <li><a href="./index.html#news">News</a></li>
            <li><a href="./gallery.html" class="active">Gallery</a></li>
            <li><a href="./index.html#contact">Contact</a></li>
            <li><a href="./payment.html" class="btn-donate">Donate</a></li>
        </ul>
        <div class="hamburger">
            <i class="fas fa-bars"></i>
        </div>
    </nav>

    <section class="section-padding">
        <div class="container">
            <h2 class="section-title">Petta Thullal Photo Gallery</h2>
            <p class="text-center">A glimpse into the sacred rituals and vibrant energy of the annual Petta Thullal
                journey.</p>

            <div class="gallery-grid" id="gallery-grid">
                <!-- Javascript will populate this -->
            </div>

            <div id="lightbox" class="lightbox" onclick="closeLightbox()">
                <span class="lightbox-close" onclick="closeLightbox()">&times;</span>
                <a class="prev-arrow" onclick="changeImage(-1); event.stopPropagation();">&#10094;</a>
                <a class="next-arrow" onclick="changeImage(1); event.stopPropagation();">&#10095;</a>

                <div class="lightbox-content" onclick="event.stopPropagation()">
                    <img id="lightbox-image" src="" alt="Full size gallery image">
                </div>
            </div>
        </div>
    </section>

    <footer id="contact">
        <div class="container footer-grid">
            <div class="footer-col">
                <h3>Ambalapuzha Yogam Petta Sangham</h3>
                <p>Preserving the divine legacy.</p>
            </div>
            <div class="footer-col">
                <h3>Contact Us</h3>
                <p>
                    <a href="https://maps.google.com/?q=Ambalapuzha, Kerala, India" target="_blank"
                        rel="noopener noreferrer">
                        <i class="fas fa-map-marker-alt"></i> Ambalapuzha, Kerala, India
                    </a>
                </p>
                <p>
                    <a href="tel:+919876543210">
                        <i class="fas fa-phone"></i> +91 98765 43210
                    </a>
                </p>
                <p>
                    <a href="mailto:info@pettasangam.org">
                        <i class="fas fa-envelope"></i> info@pettasangam.org
                    </a>
                </p>
            </div>
            <div class="footer-col">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="./index.html#home">Home</a></li>
                    <li><a href="./gallery.html">Gallery</a></li>
                    <li><a href="./index.html#news">Events</a></li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2025 Ambalapuzha Yogam Sangham Trust. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
        // --- 1. Data Structure (Dynamically loaded from gallery-data.js) ---
        // galleryData is defined in gallery-data.js as [{id, alt}, ...]

        // Initialize galleryImages array for the lightbox navigation
        let galleryImages = [];
        let currentIndex = 0;

        function initGallery() {
            const grid = document.getElementById('gallery-grid');
            grid.innerHTML = ''; // Clear any existing content

            if (typeof galleryData === 'undefined') {
                console.error("galleryData is missing! Make sure gallery-data.js is loaded.");
                return;
            }

            galleryData.forEach((item, index) => {
                // 1. Construct the Image URL
                const imageUrl = getDriveUrl(item.id);
                // Push to our lightbox array
                galleryImages.push(imageUrl);

                // 2. Create HTML Elements
                const div = document.createElement('div');
                div.className = 'gallery-item';
                div.onclick = () => openLightbox(index);

                const img = document.createElement('img');
                img.src = imageUrl;
                img.alt = item.alt || 'Gallery Image';
                img.loading = 'lazy';

                // Optional: Add error handling for images
                img.onerror = function () {
                    this.style.display = 'none'; // Hide if broken
                };

                div.appendChild(img);
                grid.appendChild(div);
            });
        }

        // Run initialization
        document.addEventListener('DOMContentLoaded', initGallery);

        // --- 2. Core Lightbox Functions ---

        function showImage(index) {
            // Handle wrapping around (the carousel effect)
            if (index >= galleryImages.length) {
                currentIndex = 0; // Wrap to the first image
            } else if (index < 0) {
                currentIndex = galleryImages.length - 1; // Wrap to the last image
            } else {
                currentIndex = index;
            }

            const lightboxImage = document.getElementById('lightbox-image');
            // Set the image source based on the new index
            lightboxImage.src = galleryImages[currentIndex];
        }

        function openLightbox(index) {
            const lightbox = document.getElementById('lightbox');

            // Set the initial image and update the index
            showImage(index);

            lightbox.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            lightbox.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function changeImage(step) {
            // step is either +1 (next) or -1 (previous)
            showImage(currentIndex + step);
        }


        // edited
        // --- MOBILE MENU TOGGLE SCRIPT ---
        const hamburger = document.querySelector('.hamburger');
        const navLinks = document.querySelector('.nav-links');
        const links = document.querySelectorAll('.nav-links li');

        hamburger.addEventListener('click', () => {
            // 1. Toggle the side menu
            navLinks.classList.toggle('nav-active');

            // 2. Animate the Links (Optional: nice fade-in effect)
            links.forEach((link, index) => {
                if (link.style.animation) {
                    link.style.animation = '';
                } else {
                    // Stagger the animation so they appear one by one
                    link.style.animation = `navLinkFade 0.5s ease forwards ${index / 7 + 0.3}s`;
                }
            });

            // 3. Burger Animation (Optional: turns lines into X)
            hamburger.classList.toggle('toggle');
        });

        // 4. Close menu when a link is clicked
        navLinks.addEventListener('click', () => {
            navLinks.classList.remove('nav-active');
            hamburger.classList.remove('toggle');
        });

    </script>
</body>

</html>